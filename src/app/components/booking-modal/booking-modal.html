<h2 mat-dialog-title>{{ 'BOOKING_MODAL.TITLE' | translate }}</h2>

<div mat-dialog-content>
    <!-- Slot Information -->
    <div class="slot-info">
        <div class="info-row">
            <span class="label">{{ 'BOOKING_MODAL.SLOT_INFO.SELECTED_TIME' | translate }}</span>
            <span class="value">{{ data.slot.time }}</span>
        </div>
        @if (data.craftsmanName) {
        <div class="info-row">
            <span class="label">{{ 'BOOKING_MODAL.SLOT_INFO.CRAFTSMAN' | translate }}</span>
            <span class="value">{{ data.craftsmanName }}</span>
        </div>
        }
    </div>

    <!-- Error Message -->
    @if (errorMessage()) {
    <div class="error-alert">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
                d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span>{{ errorMessage() }}</span>
    </div>
    }

    <!-- Booking Form -->
    <form [formGroup]="bookingForm" (ngSubmit)="onSubmit()">
        <!-- Service Selection -->
        <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ 'BOOKING_MODAL.FORM.SELECT_SERVICE' | translate }}</mat-label>
            <mat-select formControlName="serviceId" [disabled]="isLoadingServices()">
                @if (isLoadingServices()) {
                <mat-option disabled>{{ 'BOOKING_MODAL.FORM.LOADING_SERVICES' | translate }}</mat-option>
                } @else {
                @for (service of services(); track service.serviceId) {
                <mat-option [value]="service.serviceId">
                    {{ service.serviceName }}
                </mat-option>
                }
                }
            </mat-select>
            @if (hasError('serviceId')) {
            <mat-error>{{ getErrorMessage('serviceId') }}</mat-error>
            }
        </mat-form-field>

        <!-- Description -->
        <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ 'BOOKING_MODAL.FORM.DESCRIPTION' | translate }}</mat-label>
            <textarea matInput formControlName="description"
                [placeholder]="'BOOKING_MODAL.FORM.DESCRIPTION_PLACEHOLDER' | translate" rows="4"></textarea>
            @if (hasError('description')) {
            <mat-error>{{ getErrorMessage('description') }}</mat-error>
            }
        </mat-form-field>

        <!-- Location -->
        <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ 'BOOKING_MODAL.FORM.LOCATION' | translate }}</mat-label>
            <input matInput formControlName="location"
                [placeholder]="'BOOKING_MODAL.FORM.LOCATION_PLACEHOLDER' | translate" />
        </mat-form-field>

        <!-- Suggested Price -->
        <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ 'BOOKING_MODAL.FORM.SUGGESTED_PRICE' | translate }}</mat-label>
            <input matInput type="number" formControlName="suggestedPrice"
                [placeholder]="'BOOKING_MODAL.FORM.SUGGESTED_PRICE_PLACEHOLDER' | translate" step="0.01" />
            <span matPrefix>$&nbsp;</span>
            @if (hasError('suggestedPrice')) {
            <mat-error>{{ getErrorMessage('suggestedPrice') }}</mat-error>
            }
        </mat-form-field>
    </form>
</div>

<div mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()" [disabled]="isSubmitting()">
        {{ 'BOOKING_MODAL.ACTIONS.CANCEL' | translate }}
    </button>
    <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="isSubmitting() || bookingForm.invalid">
        @if (isSubmitting()) {
        <mat-spinner diameter="20"></mat-spinner>
        <span>{{ 'BOOKING_MODAL.ACTIONS.BOOKING' | translate }}</span>
        } @else {
        <span>{{ 'BOOKING_MODAL.ACTIONS.CONFIRM_BOOKING' | translate }}</span>
        }
    </button>
</div>