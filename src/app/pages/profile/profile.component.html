<div class="profile-container">
  <!-- Loading State -->
  @if (isLoading()) {
  <div class="loading-state">
    <div class="spinner"></div>
    <p class="loading-text">{{ 'PROFILE.LOADING' | translate }}</p>
  </div>
  }

  <!-- Error State -->
  @else if (errorMessage()) {
  <div class="error-container">
    <div class="error-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
      </svg>
    </div>
    <h3 class="error-title">{{ 'PROFILE.UNABLE_TO_LOAD' | translate }}</h3>
    <p class="error-message">{{ errorMessage() }}</p>
    <button class="retry-button" (click)="retryLoad()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
      </svg>
      {{ 'PROFILE.RETRY' | translate }}
    </button>
  </div>
  }

  <!-- CLIENT PROFILE -->
  @else if (isClient() && getClientProfile()) {
  <div class="profile-wrapper">
    <!-- Profile Header Card -->
    <div class="profile-header-card">
      <div class="header-background"></div>
      <div class="header-content">
        <!-- Avatar Section -->
        <div class="avatar-container">
          <div class="avatar-wrapper">
            <img [src]="getProfileImageUrl()" [alt]="getFullName()" class="avatar-image" />
            <div class="avatar-ring"></div>
          </div>
        </div>

        <!-- User Info Section -->
        <div class="user-info">
          <h1 class="user-name">{{ getFullName() }}</h1>
          <div class="user-meta">
            <span class="meta-badge meta-badge-client">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
              </svg>
              {{ 'PROFILE.CLIENT' | translate }}
            </span>
            <span class="meta-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
              </svg>
              {{ getGenderText() }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Details Grid -->
    <div class="details-grid">
      <!-- Personal Information Card -->
      <div class="detail-card">
        <div class="card-header">
          <div class="card-icon card-icon-blue">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
          </div>
          <h2 class="card-title">{{ 'PROFILE.PERSONAL_INFO' | translate }}</h2>
        </div>
        <div class="card-content">
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.FULL_NAME' | translate }}</span>
            <span class="info-value">{{ getFullName() }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.GENDER' | translate }}</span>
            <span class="info-value">{{ getGenderText() }}</span>
          </div>
        </div>
      </div>

      <!-- Contact Information Card -->
      <div class="detail-card">
        <div class="card-header">
          <div class="card-icon card-icon-green">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
            </svg>
          </div>
          <h2 class="card-title">{{ 'PROFILE.CONTACT_DETAILS' | translate }}</h2>
        </div>
        <div class="card-content">
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.PHONE_NUMBER' | translate }}</span>
            <span class="info-value">{{ getClientProfile()?.phoneNumber }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.LOCATION' | translate }}</span>
            <span class="info-value">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="location-icon">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              {{ getClientProfile()?.location }}
            </span>
          </div>
        </div>
      </div>

      <!-- Activity Card -->
      <div class="detail-card detail-card-highlight">
        <div class="card-header">
          <div class="card-icon card-icon-purple">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
            </svg>
          </div>
          <h2 class="card-title">{{ 'PROFILE.ACTIVITY_SUMMARY' | translate }}</h2>
        </div>
        <div class="card-content">
          <div class="stat-display">
            <div class="stat-number">{{ getClientProfile()?.totalRequests || 0 }}</div>
            <div class="stat-label">{{ 'PROFILE.TOTAL_SERVICE_REQUESTS' | translate }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  }

  <!-- CRAFTSMAN PROFILE -->
  @else if (isCraftsman() && getCraftsmanProfile()) {
  <div class="profile-wrapper">
    <!-- Profile Header Card -->
    <div class="profile-header-card craftsman-header">
      <div class="header-background craftsman-bg"></div>
      <div class="header-content">
        <!-- Avatar Section -->
        <div class="avatar-container">
          <div class="avatar-wrapper">
            <img [src]="getProfileImageUrl()" [alt]="getFullName()" class="avatar-image" />
            <div class="avatar-ring craftsman-ring"></div>
            @if (getCraftsmanProfile()?.isVerified) {
            <div class="verified-badge">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
              </svg>
            </div>
            }
          </div>
        </div>

        <!-- User Info Section -->
        <div class="user-info">
          <h1 class="user-name">{{ getFullName() }}</h1>
          <div class="user-meta">
            <span class="meta-badge meta-badge-craftsman">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z" />
              </svg>
              {{ 'PROFILE.CRAFTSMAN' | translate }}
            </span>
            <span class="meta-item status-verified" [class.status-unverified]="!getCraftsmanProfile()?.isVerified">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5zm-1 15l-4-4 1.41-1.41L11 14.17l6.59-6.59L19 9l-8 8z" />
              </svg>
              {{ getVerificationText() }}
            </span>
          </div>

          <!-- Rating Display -->
          <div class="rating-display">
            <div class="stars">
              @for (star of getStarArray().filled; track star) {
              <svg viewBox="0 0 24 24" fill="currentColor" class="star star-filled">
                <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />
              </svg>
              }
              @for (star of getStarArray().empty; track star) {
              <svg viewBox="0 0 24 24" fill="currentColor" class="star star-empty">
                <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />
              </svg>
              }
            </div>
            <span class="rating-text">{{ getCraftsmanProfile()?.rating || 0 }} {{ 'PROFILE.OUT_OF_5' | translate }}</span>
          </div>

          <!-- Quick Action Buttons Grid -->
          <div class="quick-actions">
            <a [routerLink]="['/craftsman', getCraftsmanProfile()?.id, 'availability']"
              class="action-button availability-button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              <span>{{ 'PROFILE.MANAGE_AVAILABILITY' | translate }}</span>
            </a>

            <a [routerLink]="['/craftsman', getCraftsmanProfile()?.id, 'timeslots']" class="action-button slots-button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <span>{{ 'PROFILE.VIEW_TIME_SLOTS' | translate }}</span>
            </a>



            <a [routerLink]="['/craftsman-wallet', getCraftsmanProfile()?.id]" class="action-button wallet-button">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z" />
              </svg>
              <span>{{ 'PROFILE.MY_WALLET' | translate }}</span>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Details Grid -->
    <div class="details-grid">
      <!-- Professional Information Card -->
      <div class="detail-card">
        <div class="card-header">
          <div class="card-icon card-icon-orange">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
          </div>
          <h2 class="card-title">{{ 'PROFILE.PROFESSIONAL_INFO' | translate }}</h2>
        </div>
        <div class="card-content">
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.FULL_NAME' | translate }}</span>
            <span class="info-value">{{ getFullName() }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.EMAIL_ADDRESS' | translate }}</span>
            <span class="info-value info-value-email">{{ getCraftsmanProfile()?.normalizedEmail }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.LOCATION' | translate }}</span>
            <span class="info-value">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="location-icon">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              {{ getCraftsmanProfile()?.location }}
            </span>
          </div>
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.PHONE_NUMBER' | translate }}</span>
            <span class="info-value">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="location-icon">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
              </svg>
              {{ getCraftsmanProfile()?.phoneNumber }}
            </span>
          </div>
        </div>
      </div>

      <!-- Experience & Rate Card -->
      <div class="detail-card">
        <div class="card-header">
          <div class="card-icon card-icon-blue">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
          </div>
          <h2 class="card-title">{{ 'PROFILE.PROFESSIONAL_DETAILS' | translate }}</h2>
        </div>
        <div class="card-content">
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.YEARS_OF_EXPERIENCE' | translate }}</span>
            <span class="info-value">{{ getCraftsmanProfile()?.experienceOfYears }} {{ 'PROFILE.YEARS' | translate }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.HOURLY_RATE' | translate }}</span>
            <span class="info-value">${{ getCraftsmanProfile()?.hourlyRate }}{{ 'PROFILE.PER_HOUR' | translate }}</span>
          </div>
        </div>
      </div>

      <!-- Performance Metrics Card -->
      <div class="detail-card detail-card-highlight craftsman-highlight clickable-card" (click)="goToReviews()">
        <div class="card-header">
          <div class="card-icon card-icon-gold">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />
            </svg>
          </div>
          <h2 class="card-title">{{ 'PROFILE.PERFORMANCE_RATING' | translate }}</h2>
          <span class="card-arrow">â†’</span>
        </div>
        <div class="card-content">
          <div class="stat-display craftsman-stat">
            <div class="stat-number craftsman-stat-number">{{ getCraftsmanProfile()?.rating || 0 }}<span
                class="stat-unit">/5.0</span></div>
            <div class="stat-label">{{ 'PROFILE.OVERALL_RATING' | translate }}</div>
            <div class="rating-bar">
              <div class="rating-bar-fill" [style.width.%]="(getCraftsmanProfile()?.rating || 0) * 20"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- About Section -->
    @if (getCraftsmanProfile()?.describtion) {
    <div class="about-card">
      <div class="card-header">
        <div class="card-icon card-icon-blue">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h7" />
          </svg>
        </div>
        <h2 class="card-title">{{ 'PROFILE.ABOUT_ME' | translate }}</h2>
      </div>
      <div class="card-content">
        <p class="about-text">{{ getCraftsmanProfile()?.describtion }}</p>
      </div>
    </div>
    }
  </div>
  }
</div>