<div class="profile-container">
  <!-- Loading State -->
  @if (isLoading()) {
  <div class="loading-state">
    <div class="spinner"></div>
    <p class="loading-text">Loading your profile...</p>
  </div>
  }

  <!-- Error State -->
  @else if (errorMessage()) {
  <div class="error-container">
    <div class="error-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
      </svg>
    </div>
    <h3 class="error-title">Unable to Load Profile</h3>
    <p class="error-message">{{ errorMessage() }}</p>
    <button class="retry-button" (click)="retryLoad()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
      </svg>
      Retry
    </button>
  </div>
  }

  <!-- CRAFTSMAN PROFILE -->
  @else if (profile()) {
  <div class="profile-wrapper">
    <!-- Profile Header Card -->
    <div class="profile-header-card craftsman-header">
      <div class="header-background craftsman-bg"></div>
      <div class="header-content">
        <!-- Avatar Section -->
        <div class="avatar-container">
          <div class="avatar-wrapper">
            <img [src]="getProfileImageUrl()" [alt]="getFullName()" class="avatar-image" />
            <div class="avatar-ring craftsman-ring"></div>
            @if (profile()?.isVerified) {
            <div class="verified-badge">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
              </svg>
            </div>
            }
          </div>
        </div>

        <!-- User Info Section -->
        <div class="user-info">
          <h1 class="user-name">{{ getFullName() }}</h1>
          <div class="user-meta">
            <span class="meta-badge meta-badge-craftsman">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z" />
              </svg>
              Craftsman
            </span>
            <span class="meta-item status-verified" [class.status-unverified]="!profile()?.isVerified">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5zm-1 15l-4-4 1.41-1.41L11 14.17l6.59-6.59L19 9l-8 8z" />
              </svg>
              {{ getVerificationText() }}
            </span>
          </div>

          <!-- Rating Display -->
          <div class="rating-display">
            <div class="stars">
              @for (star of getStarArray().filled; track star) {
              <svg viewBox="0 0 24 24" fill="currentColor" class="star star-filled">
                <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />
              </svg>
              }
              @for (star of getStarArray().empty; track star) {
              <svg viewBox="0 0 24 24" fill="currentColor" class="star star-empty">
                <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />
              </svg>
              }
            </div>
            <span class="rating-text">{{ profile()?.rating || 0 }} out of 5</span>
          </div>

          <!-- Book Appointment Button -->
          <div class="booking-cta">
            <a [routerLink]="['/craftsman', profile()?.id, 'timeslots']" class="book-button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              <span>Book Appointment</span>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Details Grid -->
    <div class="details-grid">
      <!-- Professional Information Card -->
      <div class="detail-card">
        <div class="card-header">
          <div class="card-icon card-icon-orange">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
          </div>
          <h2 class="card-title">Professional Info</h2>
        </div>
        <div class="card-content">
          <div class="info-row">
            <span class="info-label">Full Name</span>
            <span class="info-value">{{ getFullName() }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Email Address</span>
            <span class="info-value info-value-email">{{ profile()?.normalizedEmail }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Location</span>
            <span class="info-value">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="location-icon">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              {{ profile()?.location }}
            </span>
          </div>
        </div>
      </div>

      <!-- Performance Metrics Card -->
      <div class="detail-card detail-card-highlight craftsman-highlight">
        <div class="card-header">
          <div class="card-icon card-icon-gold">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />
            </svg>
          </div>
          <h2 class="card-title">Performance Rating</h2>
        </div>
        <div class="card-content">
          <div class="stat-display craftsman-stat">
            <div class="stat-number craftsman-stat-number">{{ profile()?.rating || 0 }}<span
                class="stat-unit">/5.0</span></div>
            <div class="stat-label">Overall Rating</div>
            <div class="rating-bar">
              <div class="rating-bar-fill" [style.width.%]="(profile()?.rating || 0) * 20"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Verification Status Card -->
      <div class="detail-card" [class.verified-card]="profile()?.isVerified">
        <div class="card-header">
          <div class="card-icon" [class.card-icon-success]="profile()?.isVerified"
            [class.card-icon-gray]="!profile()?.isVerified">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5zm-1 15l-4-4 1.41-1.41L11 14.17l6.59-6.59L19 9l-8 8z" />
            </svg>
          </div>
          <h2 class="card-title">Verification Status</h2>
        </div>
        <div class="card-content">
          <div class="verification-status">
            <div class="status-indicator" [class.status-indicator-verified]="profile()?.isVerified"
              [class.status-indicator-pending]="!profile()?.isVerified"></div>
            <span class="status-text">{{ getVerificationText() }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- About Section -->
    @if (profile()?.describtion) {
    <div class="about-card">
      <div class="card-header">
        <div class="card-icon card-icon-blue">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h7" />
          </svg>
        </div>
        <h2 class="card-title">About Me</h2>
      </div>
      <div class="card-content">
        <p class="about-text">{{ profile()?.describtion }}</p>
      </div>
    </div>
    }
  </div>
  }
</div>