<div class="appointment-container">
    <!-- Header -->
    <div class="header">
        <button class="back-button" (click)="goBack()">
            <span>←</span> Back
        </button>
        <h1>Schedule Appointment</h1>
    </div>

    <!-- Craftsman Info -->
    <div class="craftsman-card" *ngIf="craftsman">
        <img [src]="craftsman.profileImage" [alt]="craftsman.fName" class="craftsman-photo">
        <div class="craftsman-details">
            <h2>{{ craftsman.fName }} {{ craftsman.lName }}</h2>
            <p class="specialization">{{ craftsman.describtion }}</p>
            <div class="rating" *ngIf="craftsman.rating">
                <span class="stars">★</span>
                <span>{{ craftsman.rating }}</span>
            </div>
        </div>
    </div>

    <!-- Date Selection -->
    <div class="date-section">
        <h3>Select Date</h3>
        <input type="date" [value]="selectedDate" [min]="getMinDate()"
            (change)="onDateSelected($any($event.target).value)" class="date-picker">
    </div>

    <!-- Time Slots -->
    <div class="slots-section">
        <h3>Available Time Slots</h3>

        <!-- Loading State -->
        <div *ngIf="loadingSlots" class="loading">
            <div class="spinner"></div>
            <p>Loading available times...</p>
        </div>

        <!-- Error State -->
        <div *ngIf="slotsError && !loadingSlots" class="error-message">
            {{ slotsError }}
        </div>

        <!-- Slots Grid -->
        <div *ngIf="!loadingSlots && !slotsError && availableSlots.length > 0" class="slots-grid">
            <button *ngFor="let slot of availableSlots" class="slot-button" [class.selected]="selectedTimeSlot === slot"
                (click)="onSlotSelected(slot)">
                {{ slot.time }}
            </button>
        </div>
    </div>

    <!-- Booking Summary -->
    <div class="booking-summary" *ngIf="selectedTimeSlot">
        <h3>Booking Summary</h3>
        <div class="summary-item">
            <span class="label">Date:</span>
            <span class="value">{{ selectedDate | date:'fullDate' }}</span>
        </div>
        <div class="summary-item">
            <span class="label">Time:</span>
            <span class="value">{{ selectedTimeSlot.time }}</span>
        </div>
        <div class="summary-item">
            <span class="label">Craftsman:</span>
            <span class="value">{{ craftsman?.fName }} {{ craftsman?.lName }}</span>
        </div>
    </div>

    <!-- Confirm Button -->
    <div class="actions">
        <button class="confirm-button" [disabled]="!selectedTimeSlot || isBooking" (click)="confirmBooking()">
            <span *ngIf="!isBooking">Confirm Appointment</span>
            <span *ngIf="isBooking">
                <span class="spinner-sm"></span> Booking...
            </span>
        </button>
    </div>
</div>