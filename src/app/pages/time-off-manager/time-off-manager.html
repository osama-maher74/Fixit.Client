<div class="timeoff-container">
    <h1>Manage Time Off</h1>

    <!-- Messages -->
    @if (errorMessage()) {
    <div class="alert alert-error">{{ errorMessage() }}</div>
    }
    @if (successMessage()) {
    <div class="alert alert-success">{{ successMessage() }}</div>
    }

    <!-- Add Time Off Form -->
    <div class="form-card">
        <h2>Request Time Off</h2>
        <form [formGroup]="timeOffForm" (ngSubmit)="onSubmit()">
            <div class="form-row">
                <div class="form-group">
                    <label>Start Date & Time</label>
                    <input type="datetime-local" formControlName="startDateTime" class="form-control" />
                </div>
                <div class="form-group">
                    <label>End Date & Time</label>
                    <input type="datetime-local" formControlName="endDateTime" class="form-control" />
                </div>
            </div>
            <div class="form-group">
                <label>Reason (optional)</label>
                <textarea formControlName="reason" class="form-control" rows="3"
                    placeholder="Vacation, illness, etc."></textarea>
            </div>
            <button type="submit" class="btn btn-primary" [disabled]="isSaving()">
                {{ isSaving() ? 'Adding...' : 'Add Time Off' }}
            </button>
        </form>
    </div>

    <!-- Time Off List -->
    <div class="list-card">
        <h2>Scheduled Time Off</h2>
        @if (isLoading()) {
        <div class="loading">
            <div class="spinner"></div>
            <p>Loading...</p>
        </div>
        } @else if (timeOffList().length === 0) {
        <p class="empty">No time-off scheduled</p>
        } @else {
        @for (item of timeOffList(); track item.id) {
        <div class="timeoff-item">
            <div class="timeoff-info">
                <div class="dates">
                    <strong>{{ formatDateTime(item.startDateTime) }}</strong>
                    <span> to </span>
                    <strong>{{ formatDateTime(item.endDateTime) }}</strong>
                </div>
                @if (item.reason) {
                <div class="reason">{{ item.reason }}</div>
                }
            </div>
            <button class="btn-delete" (click)="deleteTimeOff(item.id)">Delete</button>
        </div>
        }
        }
    </div>
</div>