<div class="verify-id-page">
  <!-- Loading State -->
  @if (isLoading()) {
  <div class="loading-container">
    <div class="spinner"></div>
    <p>{{ 'COMMON.LOADING' | translate }}</p>
  </div>
  }

  <!-- Error State -->
  @else if (errorMessage()) {
  <div class="error-container">
    <div class="error-icon">⚠️</div>
    <p class="error-text">{{ errorMessage() }}</p>
    <button class="btn btn-primary" (click)="goBack()">
      {{ 'COMMON.GO_BACK' | translate }}
    </button>
  </div>
  }

  <!-- Main Content -->
  @else {
  <div class="verify-id-container">
    <!-- Header -->
    <div class="page-header">
      <button class="back-button" (click)="goBack()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        <span>{{ 'COMMON.BACK' | translate }}</span>
      </button>
    </div>

    <!-- Success Message -->
    @if (successMessage()) {
    <div class="alert alert-success">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span>{{ successMessage() }}</span>
    </div>
    }

    <!-- ID Verification Section -->
    <div class="id-verification-section">
      <div class="verification-header">
        <div class="header-content">
          <h1 class="verification-title">{{ 'ID_VERIFICATION.TITLE' | translate }}</h1>
          <p class="verification-subtitle">{{ 'ID_VERIFICATION.SUBTITLE' | translate }}</p>
        </div>
        @if (isVerified()) {
          <div class="verified-badge">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <span>{{ 'PROFILE.VERIFIED' | translate }}</span>
          </div>
        }
      </div>

      @if (isVerified()) {
        <!-- Already Verified Message -->
        <div class="alert alert-success">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span>{{ 'ID_VERIFICATION.ALREADY_VERIFIED' | translate }}</span>
        </div>
      } @else {
        <!-- Instructions -->
        <div class="verification-instructions">
          <h3 class="instructions-title">{{ 'ID_VERIFICATION.INSTRUCTIONS_TITLE' | translate }}</h3>
          <ul class="instructions-list">
            <li>{{ 'ID_VERIFICATION.INSTRUCTION_1' | translate }}</li>
            <li>{{ 'ID_VERIFICATION.INSTRUCTION_2' | translate }}</li>
            <li>{{ 'ID_VERIFICATION.INSTRUCTION_3' | translate }}</li>
            <li>{{ 'ID_VERIFICATION.INSTRUCTION_4' | translate }}</li>
            <li>{{ 'ID_VERIFICATION.INSTRUCTION_5' | translate }}</li>
            <li>{{ 'ID_VERIFICATION.INSTRUCTION_6' | translate }}</li>
          </ul>
        </div>

        <!-- Why Verify -->
        <div class="why-verify-section">
          <h3 class="why-verify-title">{{ 'ID_VERIFICATION.WHY_VERIFY_TITLE' | translate }}</h3>
          <div class="benefits-grid">
            <div class="benefit-card">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
              </svg>
              <span>{{ 'ID_VERIFICATION.WHY_VERIFY_1' | translate }}</span>
            </div>
            <div class="benefit-card">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
              </svg>
              <span>{{ 'ID_VERIFICATION.WHY_VERIFY_2' | translate }}</span>
            </div>
            <div class="benefit-card">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7" />
              </svg>
              <span>{{ 'ID_VERIFICATION.WHY_VERIFY_3' | translate }}</span>
            </div>
            <div class="benefit-card">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
              </svg>
              <span>{{ 'ID_VERIFICATION.WHY_VERIFY_4' | translate }}</span>
            </div>
          </div>
        </div>

        <!-- Verification Errors -->
        @if (verificationErrors().length > 0) {
          <div class="alert alert-error">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <div>
              <h4 class="alert-title">{{ 'ID_VERIFICATION.VERIFICATION_FAILED' | translate }}</h4>
              <ul class="error-list">
                @for (error of verificationErrors(); track $index) {
                  <li>{{ error }}</li>
                }
              </ul>
            </div>
          </div>
        }

        <!-- ID Upload Area -->
        <div class="id-upload-grid">
          <!-- Front Image Upload -->
          <div class="id-upload-card">
            <label class="id-upload-label">{{ 'ID_VERIFICATION.FRONT_PHOTO' | translate }}</label>
            @if (idFrontPreview()) {
              <div class="id-preview-container">
                <img [src]="idFrontPreview()" alt="Front ID" class="id-preview-image" />
                <button type="button" class="remove-id-btn" (click)="removeIdFrontImage()">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
            } @else {
              <div class="id-upload-placeholder">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2" />
                </svg>
                <p>{{ 'ID_VERIFICATION.UPLOAD_FRONT' | translate }}</p>
              </div>
            }
            <label for="idFrontInput" class="id-upload-btn">
              {{ idFrontPreview() ? ('ID_VERIFICATION.CHANGE_PHOTO' | translate) : ('ID_VERIFICATION.CHOOSE_PHOTO' | translate) }}
            </label>
            <input id="idFrontInput" type="file" accept="image/jpeg,image/jpg,image/png" (change)="onIdFrontImageSelected($event)" class="file-input" />
            <p class="id-upload-hint">{{ 'ID_VERIFICATION.IMAGE_HINT' | translate }}</p>
          </div>

          <!-- Back Image Upload -->
          <div class="id-upload-card">
            <label class="id-upload-label">{{ 'ID_VERIFICATION.BACK_PHOTO' | translate }}</label>
            @if (idBackPreview()) {
              <div class="id-preview-container">
                <img [src]="idBackPreview()" alt="Back ID" class="id-preview-image" />
                <button type="button" class="remove-id-btn" (click)="removeIdBackImage()">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
            } @else {
              <div class="id-upload-placeholder">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2" />
                </svg>
                <p>{{ 'ID_VERIFICATION.UPLOAD_BACK' | translate }}</p>
              </div>
            }
            <label for="idBackInput" class="id-upload-btn">
              {{ idBackPreview() ? ('ID_VERIFICATION.CHANGE_PHOTO' | translate) : ('ID_VERIFICATION.CHOOSE_PHOTO' | translate) }}
            </label>
            <input id="idBackInput" type="file" accept="image/jpeg,image/jpg,image/png" (change)="onIdBackImageSelected($event)" class="file-input" />
            <p class="id-upload-hint">{{ 'ID_VERIFICATION.IMAGE_HINT' | translate }}</p>
          </div>
        </div>

        <!-- Verify Button -->
        <div class="verify-button-container">
          <button type="button" class="btn btn-verify" (click)="verifyNationalId()" [disabled]="!idFrontImage() || !idBackImage() || isVerifying()">
            @if (isVerifying()) {
              <div class="btn-spinner"></div>
              <span>{{ 'ID_VERIFICATION.VERIFYING' | translate }}</span>
            } @else {
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
              </svg>
              <span>{{ 'ID_VERIFICATION.VERIFY_BUTTON' | translate }}</span>
            }
          </button>
        </div>
      }
    </div>
  </div>
  }
</div>
